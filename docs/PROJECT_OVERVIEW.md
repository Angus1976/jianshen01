# ğŸ‹ï¸ RocketBird é¡¹ç›®æ€»è§ˆ

## ğŸ“± é¡¹ç›®ç®€ä»‹

**RocketBird** æ˜¯ä¸€ä¸ªé›†æˆçš„å¥èº«ä¼šå‘˜ç®¡ç†å¹³å°ï¼ŒåŒ…å«ä¸‰ä¸ªæ ¸å¿ƒåº”ç”¨ï¼š

1. **H5 ä¼šå‘˜ç«¯** (`packages/member-h5`) - ç”¨æˆ·æŸ¥çœ‹ä¼šå‘˜æƒç›Šã€ç­¾åˆ°ã€ç§¯åˆ†ç­‰
2. **ç®¡ç†åå°** (`packages/admin`) - è¿è¥äººå‘˜ç®¡ç†ä¼šå‘˜ã€ç§¯åˆ†ã€æƒç›Šç­‰
3. **åç«¯ API** (`packages/server`) - å¤„ç†æ‰€æœ‰ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ç”¨æˆ·æµè§ˆå™¨                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ H5 ä¼šå‘˜ç«¯       â”‚  â”‚ ç®¡ç†åå°     â”‚ â”‚
â”‚  â”‚ Vue3 + uni-app  â”‚  â”‚ React + Vite â”‚ â”‚
â”‚  â”‚ Port: é»˜è®¤      â”‚  â”‚ /admin       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚           â”‚                  â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ HTTP/HTTPS
                       â”‚ /api
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  Express.js åç«¯ API   â”‚
            â”‚  - äº‘å‡½æ•° (Nodejs 12) â”‚
            â”‚  - 512MB å†…å­˜          â”‚
            â”‚  - 30s è¶…æ—¶            â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  TCB æ–‡æ¡£æ•°æ®åº“       â”‚
            â”‚  - users              â”‚
            â”‚  - members            â”‚
            â”‚  - points_records     â”‚
            â”‚  - checkins           â”‚
            â”‚  - benefits           â”‚
            â”‚  - etc.               â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ éƒ¨ç½²æ¶æ„

### Tencent CloudBase (TCB)

**ç¯å¢ƒ ID**: `cloud1-4g2aaqb40446a63b`

#### 1ï¸âƒ£ é™æ€ç½‘ç«™æ‰˜ç®¡

```
Domain: https://cloud1-4g2aaqb40446a63b-1390089965.tcloudbaseapp.com

â”œâ”€ /                    â†’ H5 ä¼šå‘˜ç«¯ (packages/member-h5/dist)
â”œâ”€ /admin              â†’ ç®¡ç†åå° (packages/admin/dist)
â””â”€ /api/...            â†’ åç«¯ API (HTTP è§¦å‘å™¨)
```

#### 2ï¸âƒ£ äº‘å‡½æ•°

```
å‡½æ•°å: api
è¿è¡Œç¯å¢ƒ: Node.js 12.16
å†…å­˜å¤§å°: 512 MB
è¶…æ—¶æ—¶é—´: 30 ç§’
å…¥å£æ–‡ä»¶: dist/app.js
ä¸»å‡½æ•°: main
```

#### 3ï¸âƒ£ æ•°æ®åº“

```
ç±»å‹: æ–‡æ¡£æ•°æ®åº“ï¼ˆMongoDB å…¼å®¹ï¼‰
é›†åˆ: è‡ªåŠ¨åˆ›å»º
è®¤è¯: TCB è¿æ¥å­—ç¬¦ä¸²
```

#### 4ï¸âƒ£ è§¦å‘å™¨

```
HTTP è§¦å‘å™¨        â†’ /api è·¯ç”±
å®šæ—¶è§¦å‘å™¨ (å¯é€‰)  â†’ æ—¥æ¸…ç†ã€å°æ—¶ç»Ÿè®¡ç­‰
```

---

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
RocketBird/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ member-h5/          # H5 ä¼šå‘˜ç«¯
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ App.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ main.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ pages/      # é¡µé¢ï¼ˆç­¾åˆ°ã€ç§¯åˆ†ã€æƒç›Šç­‰ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ components/ # å…¬ç”¨ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ api/        # API è°ƒç”¨
â”‚   â”‚   â”‚   â”œâ”€â”€ stores/     # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ utils/      # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ vite.config.ts  # æ„å»ºé…ç½®
â”‚   â”‚   â””â”€â”€ cloudbaserc.json
â”‚   â”‚
â”‚   â”œâ”€â”€ admin/              # ç®¡ç†åå°
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ App.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ main.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ pages/      # ç®¡ç†é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ components/ # å¤ç”¨ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ services/   # API è°ƒç”¨
â”‚   â”‚   â”‚   â”œâ”€â”€ stores/     # Pinia çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ utils/      # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ vite.config.ts
â”‚   â”‚   â””â”€â”€ cloudbaserc.json
â”‚   â”‚
â”‚   â”œâ”€â”€ server/             # åç«¯ API
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ app.ts      # Express ä¸»åº”ç”¨
â”‚   â”‚   â”‚   â”œâ”€â”€ config/     # æ•°æ®åº“é…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ models/     # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ routes/     # è·¯ç”±å®šä¹‰
â”‚   â”‚   â”‚   â”œâ”€â”€ services/   # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”‚   â””â”€â”€ utils/      # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”‚   â”œâ”€â”€ Dockerfile      # Docker é•œåƒ
â”‚   â”‚   â””â”€â”€ cloudbaserc.json
â”‚   â”‚
â”‚   â””â”€â”€ shared/             # å…±äº«åŒ…
â”‚       â”œâ”€â”€ types/          # TypeScript ç±»å‹å®šä¹‰
â”‚       â”œâ”€â”€ constants/      # å¸¸é‡
â”‚       â”œâ”€â”€ utils/          # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ package.json
â”‚       â””â”€â”€ tsconfig.json
â”‚
â”œâ”€â”€ docs/                   # æ–‡æ¡£
â”‚   â”œâ”€â”€ PROJECT_OVERVIEW.md (æœ¬æ–‡ä»¶)
â”‚   â”œâ”€â”€ DEPLOYMENT_COMPLETE.md
â”‚   â”œâ”€â”€ TRIGGER_CONFIG.md
â”‚   â”œâ”€â”€ QUICK_REFERENCE.md
â”‚   â””â”€â”€ SCRIPTS_GUIDE.md
â”‚
â”œâ”€â”€ scripts/                # è‡ªåŠ¨åŒ–è„šæœ¬
â”‚   â”œâ”€â”€ deploy-tcb.sh       # éƒ¨ç½²è„šæœ¬
â”‚   â”œâ”€â”€ setup-cloudbase.sh  # é…ç½®è„šæœ¬ï¼ˆBashï¼‰
â”‚   â””â”€â”€ setup-cloudbase.py  # é…ç½®è„šæœ¬ï¼ˆPythonï¼‰
â”‚
â”œâ”€â”€ openspec/               # åŠŸèƒ½è§„æ ¼æ–‡æ¡£
â”‚   â”œâ”€â”€ AGENTS.md
â”‚   â”œâ”€â”€ project.md
â”‚   â””â”€â”€ specs/              # å„æ¨¡å—è§„æ ¼
â”‚
â”œâ”€â”€ README.md
â”œâ”€â”€ package.json            # æ ¹çº§ä¾èµ–
â””â”€â”€ tsconfig.base.json      # æ ¹çº§ TS é…ç½®
```

---

## ğŸ”‘ æ ¸å¿ƒæŠ€æœ¯æ ˆ

### å‰ç«¯æŠ€æœ¯

| æŠ€æœ¯ | ç”¨é€” | ç‰ˆæœ¬ |
|------|------|------|
| **Vue 3** | H5 æ¡†æ¶ | æœ€æ–° |
| **uni-app** | è·¨ç«¯å¼€å‘ | æœ€æ–° |
| **React** | ç®¡ç†åå°æ¡†æ¶ | 18+ |
| **Vite** | æ„å»ºå·¥å…· | 5+ |
| **TypeScript** | ç±»å‹æ£€æŸ¥ | æœ€æ–° |
| **Pinia** | çŠ¶æ€ç®¡ç† (admin) | æœ€æ–° |

### åç«¯æŠ€æœ¯

| æŠ€æœ¯ | ç”¨é€” | ç‰ˆæœ¬ |
|------|------|------|
| **Express.js** | Web æ¡†æ¶ | 4+ |
| **TypeScript** | ç±»å‹æ£€æŸ¥ | æœ€æ–° |
| **cloudbase-node-sdk** | TCB æ¥å…¥ | æœ€æ–° |
| **jsonwebtoken** | è®¤è¯ | æœ€æ–° |

### åŸºç¡€è®¾æ–½

| æœåŠ¡ | ç”¨é€” |
|------|------|
| **Tencent CloudBase** | äº‘è®¡ç®—å¹³å° |
| **é™æ€ç½‘ç«™æ‰˜ç®¡** | å‰ç«¯éƒ¨ç½² |
| **äº‘å‡½æ•°** | åç«¯ API |
| **æ–‡æ¡£æ•°æ®åº“** | æ•°æ®å­˜å‚¨ |

---

## ğŸ‘¥ åŠŸèƒ½æ¨¡å—

### 1. è®¤è¯ç³»ç»Ÿ (`member-auth`)
- å¯†ç ç™»å½•
- JWT Token
- ä¸ªäººèµ„æ–™ç®¡ç†

### 2. ä¼šå‘˜ç­‰çº§ (`member-level`)
- ç­‰çº§åˆ’åˆ†
- ç­‰çº§æƒç›Š
- ç­‰çº§å‡çº§è§„åˆ™

### 3. ç§¯åˆ†ç³»ç»Ÿ (`points-system`)
- ç§¯åˆ†è®¡ç®—
- ç§¯åˆ†å…‘æ¢
- ç§¯åˆ†è®°å½•

### 4. ç­¾åˆ°åŠŸèƒ½ (`checkin-share`)
- æ—¥å¸¸ç­¾åˆ°
- ç­¾åˆ°å¥–åŠ±
- ç­¾åˆ°ç»Ÿè®¡

### 5. æƒç›Šç®¡ç† (`member-benefits`)
- æƒç›Šåˆ—è¡¨
- æƒç›Šä½¿ç”¨
- æƒç›Šæœ‰æ•ˆæœŸ

### 6. å“ç‰Œå†…å®¹ (`brand-content`)
- å†…å®¹å‘å¸ƒ
- å†…å®¹ç®¡ç†
- å†…å®¹æ¨è

### 7. åé¦ˆç³»ç»Ÿ (`feedback-system`)
- ç”¨æˆ·åé¦ˆ
- åé¦ˆå¤„ç†
- åé¦ˆè·Ÿè¿›

### 8. æ¨èç³»ç»Ÿ (`referral`)
- é‚€è¯·é“¾æ¥
- æ¨èå¥–åŠ±
- æ¨èè®°å½•

### 9. å¥èº«é¤é¥® (`fitness-meals`)
- é¤é¥®å»ºè®®
- è¥å…»æ­é…
- é¥®é£Ÿè®¡åˆ’

### 10. ç®¡ç†ç³»ç»Ÿ (`admin-system`)
- ç”¨æˆ·ç®¡ç†
- æ•°æ®ç»Ÿè®¡
- ç³»ç»Ÿè®¾ç½®

---

## ğŸ§ª æµ‹è¯•è´¦æˆ·

### 5 ä¸ªé¢„è®¾æµ‹è¯•è´¦æˆ·

```
è´¦æˆ·1: 13800000001 / 123456
è´¦æˆ·2: 13800000002 / 123456
è´¦æˆ·3: 13800000003 / 123456
è´¦æˆ·4: 13800000004 / 123456
è´¦æˆ·5: 13800000005 / 123456
```

**è®¿é—® URL**:
- ä¼šå‘˜ç«¯: https://cloud1-4g2aaqb40446a63b-1390089965.tcloudbaseapp.com
- ç®¡ç†ç«¯: https://cloud1-4g2aaqb40446a63b-1390089965.tcloudbaseapp.com/admin
- API åŸºç¡€ URL: `/api`

---

## ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤

### å¼€å‘ç›¸å…³

```bash
# å®‰è£…ä¾èµ–
npm install

# H5 å¼€å‘æ¨¡å¼
cd packages/member-h5
npm run dev

# ç®¡ç†åå°å¼€å‘æ¨¡å¼
cd packages/admin
npm run dev

# åç«¯å¼€å‘æ¨¡å¼
cd packages/server
npm run dev

# æ„å»ºæ‰€æœ‰
npm run build
```

### éƒ¨ç½²ç›¸å…³

```bash
# éƒ¨ç½²åˆ° TCB
bash scripts/deploy-tcb.sh

# éƒ¨ç½²ç‰¹å®šæ¨¡å—
bash scripts/deploy-tcb.sh server
bash scripts/deploy-tcb.sh admin
bash scripts/deploy-tcb.sh h5

# æŸ¥çœ‹é…ç½®
python3 scripts/setup-cloudbase.py --manual-steps

# è·å– API æµ‹è¯•å‘½ä»¤
python3 scripts/setup-cloudbase.py --curl-examples
```

### æŸ¥çœ‹æ—¥å¿—

```bash
# æŸ¥çœ‹äº‘å‡½æ•°æ—¥å¿—
tcb fn log api -e cloud1-4g2aaqb40446a63b

# è·Ÿè¸ªæ—¥å¿—
tcb fn log api -e cloud1-4g2aaqb40446a63b --follow
```

---

## ğŸ“Š æ•°æ®åº“é›†åˆ

### è‡ªåŠ¨åˆ›å»ºçš„é›†åˆ

| é›†åˆå | ç”¨é€” | ä¸»è¦å­—æ®µ |
|--------|------|---------|
| `users` | ç”¨æˆ·è´¦æˆ· | phone, password, createdAt |
| `members` | ä¼šå‘˜ä¿¡æ¯ | userId, level, points, benefits |
| `points_records` | ç§¯åˆ†è®°å½• | userId, points, type, createdAt |
| `checkins` | ç­¾åˆ°è®°å½• | userId, date, reward, createdAt |
| `benefits` | æƒç›Šåˆ—è¡¨ | name, description, validUntil |
| `feedback` | åé¦ˆä¿¡æ¯ | userId, content, status, createdAt |
| `referrals` | æ¨èè®°å½• | referrerId, refereeId, reward, createdAt |
| `meals` | é¤é¥®å»ºè®® | title, nutrition, createdAt |

---

## ğŸ” å®‰å…¨é…ç½®

### ç¯å¢ƒå˜é‡

```env
# TCB é…ç½®
CLOUDBASE_ENV_ID=cloud1-4g2aaqb40446a63b

# JWT é…ç½®
JWT_SECRET=your-secret-key
JWT_EXPIRES_IN=7d

# CORS é…ç½®
CORS_ORIGIN=https://cloud1-4g2aaqb40446a63b-1390089965.tcloudbaseapp.com

# API é…ç½®
API_TIMEOUT=30000
API_RATE_LIMIT=100
```

### CORS ç™½åå•

```
âœ… https://cloud1-4g2aaqb40446a63b-1390089965.tcloudbaseapp.com (H5)
âœ… https://cloud1-4g2aaqb40446a63b-1390089965.tcloudbaseapp.com/admin (Admin)
âœ… http://localhost:* (å¼€å‘ç¯å¢ƒ)
```

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### äº‘å‡½æ•°é…ç½®

```
å†…å­˜: 512 MB
è¶…æ—¶: 30 ç§’
å¹¶å‘: è‡ªåŠ¨æ‰©å±•
å†·å¯åŠ¨: ~1s (Node.js 12)
```

### å‰ç«¯æ€§èƒ½

```
H5 é¦–å±: ~2s
Admin é¦–å±: ~1.5s
Lighthouse Score: 90+
```

---

## ğŸš¨ å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜ 1: API 404 é”™è¯¯

**ç—‡çŠ¶**: H5 ç™»å½•æ—¶æç¤º "API not found"

**åŸå› **: HTTP è§¦å‘å™¨æœªé…ç½®

**è§£å†³**:
```bash
# æŸ¥çœ‹é…ç½®æ­¥éª¤
python3 scripts/setup-cloudbase.py --manual-steps

# åœ¨ TCB æ§åˆ¶å°æ·»åŠ  HTTP è§¦å‘å™¨
# è·¯å¾„: /api
# æ–¹æ³•: GET, POST, PUT, DELETE, OPTIONS
```

### é—®é¢˜ 2: CORS é”™è¯¯

**ç—‡çŠ¶**: æµè§ˆå™¨æ˜¾ç¤º "Access to XMLHttpRequest blocked by CORS"

**åŸå› **: API æºæœªåœ¨ç™½åå•ä¸­

**è§£å†³**: æ£€æŸ¥ `packages/server/src/app.ts` ä¸­çš„ CORS é…ç½®

### é—®é¢˜ 3: æ•°æ®åº“è¿æ¥å¤±è´¥

**ç—‡çŠ¶**: "Database connection timeout"

**åŸå› **: TCB ç¯å¢ƒæœªæ­£ç¡®åˆå§‹åŒ–

**è§£å†³**:
```typescript
// æ£€æŸ¥ packages/server/src/config/database.ts
await initTCB();
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

| æ–‡æ¡£ | ç”¨é€” |
|------|------|
| [`DEPLOYMENT_COMPLETE.md`](./DEPLOYMENT_COMPLETE.md) | å®Œæ•´éƒ¨ç½²æŒ‡å— |
| [`TRIGGER_CONFIG.md`](./TRIGGER_CONFIG.md) | è§¦å‘å™¨é…ç½®è¯¦æƒ… |
| [`QUICK_REFERENCE.md`](./QUICK_REFERENCE.md) | å¿«é€Ÿå‚è€ƒå¡ |
| [`SCRIPTS_GUIDE.md`](./SCRIPTS_GUIDE.md) | è„šæœ¬ä½¿ç”¨è¯´æ˜ |

---

## ğŸ¯ ä¸‹ä¸€æ­¥

1. âœ… éƒ¨ç½²å®Œæˆ
2. â³ **é…ç½® HTTP è§¦å‘å™¨** (å¿…éœ€)
3. â³ æµ‹è¯•ç™»å½•åŠŸèƒ½
4. â³ é…ç½®å®šæ—¶ä»»åŠ¡ (å¯é€‰)
5. â³ ç›‘æ§æ—¥å¿—å’Œæ€§èƒ½

---

**é¡¹ç›®çŠ¶æ€**: ğŸŸ¢ **ç”Ÿäº§å°±ç»ª**

**æœ€åæ›´æ–°**: 2025-12-04

**ç»´æŠ¤è€…**: RocketBird Team
